<ui-modal
  [isOpen]="isOpen()"
  size="md"
  position="right"
  (close)="close.emit()"
>
  <!-- Header -->
  <div class="mb-6">
    <h2 id="modal-title" class="text-2xl font-display text-smoke-50 mb-2">
      {{ activeTab() === 'create' ? 'Créer un club' : 'Rejoindre un club' }}
    </h2>
    <p class="text-sm text-smoke-400">
      {{ activeTab() === 'create'
        ? 'Créez votre propre club privé pour partager vos dégustations'
        : 'Rejoignez un club existant avec un code d\'invitation'
      }}
    </p>
  </div>

  <!-- Tabs -->
  <div class="flex gap-2 mb-6">
    <button
      type="button"
      (click)="setTab('create')"
      [class]="getTabClasses('create')"
    >
      Créer
    </button>
    <button
      type="button"
      (click)="setTab('join')"
      [class]="getTabClasses('join')"
    >
      Rejoindre
    </button>
  </div>

  <!-- Create Club Form -->
  @if (activeTab() === 'create') {
    <form [formGroup]="createClubForm" (ngSubmit)="onCreateClub()" class="space-y-4">
      <ui-input
        inputId="club-name"
        type="text"
        label="Nom du club"
        placeholder="Ex: Les Aficionados de Paris"
        [control]="nameControl"
        [required]="true"
        [maxlength]="50"
        autocomplete="off"
      />

      <ui-input
        inputId="club-description"
        type="text"
        label="Description (optionnel)"
        placeholder="Ex: Club de passionnés de cigares cubains"
        [control]="descriptionControl"
        [maxlength]="200"
        autocomplete="off"
      />

      <!-- Type Selection -->
      <div class="space-y-2">
        <label class="block text-sm font-medium text-smoke-200">
          Type de club
        </label>
        <div class="flex gap-3">
          <button
            type="button"
            (click)="setClubType('private')"
            [class]="getTypeButtonClasses('private')"
          >
            <i name="lock" class="w-5 h-5"></i>
            <div class="text-left">
              <div class="font-semibold">Privé</div>
              <div class="text-xs opacity-80">Sur invitation uniquement</div>
            </div>
          </button>
          <button
            type="button"
            (click)="setClubType('public')"
            [class]="getTypeButtonClasses('public')"
          >
            <i name="globe" class="w-5 h-5"></i>
            <div class="text-left">
              <div class="font-semibold">Public</div>
              <div class="text-xs opacity-80">Ouvert à tous</div>
            </div>
          </button>
        </div>
      </div>

      <div class="flex justify-end gap-3 pt-4">
        <ui-button
          variant="ghost"
          type="button"
          (clicked)="close.emit()"
        >
          Annuler
        </ui-button>
        <ui-button
          variant="primary"
          type="submit"
          [loading]="isCreating()"
          [disabled]="isCreating() || !isCreateFormValid()"
        >
          Créer le club
        </ui-button>
      </div>
    </form>
  }

  <!-- Join Club Form -->
  @if (activeTab() === 'join') {
    <form [formGroup]="joinClubForm" (ngSubmit)="onJoinClub()" class="space-y-4">
      <ui-input
        inputId="invitation-code"
        type="text"
        label="Code d'invitation"
        placeholder="Ex: ABC-123-XYZ"
        [control]="invitationCodeControl"
        [required]="true"
        autocomplete="off"
        hint="Demandez un code d'invitation au créateur du club"
      />

      <div class="flex justify-end gap-3 pt-4">
        <ui-button
          variant="ghost"
          type="button"
          (clicked)="close.emit()"
        >
          Annuler
        </ui-button>
        <ui-button
          variant="primary"
          type="submit"
          [loading]="isJoining()"
          [disabled]="isJoining() || invitationCodeControl.invalid"
        >
          Rejoindre
        </ui-button>
      </div>
    </form>
  }
</ui-modal>
