<div class="mx-auto max-w-6xl space-y-12 px-6 py-16">
    <!-- Page Header -->
    <ui-page-header
      title="Paramètres"
      description="Gérez votre profil et vos préférences"
    />

    <!-- Messages wrapped to preserve space-y -->
<!--    @if (avatarMessage() || profileSuccess() || userStore.updateProfile.error()) {-->
<!--      <div class="space-y-4">-->
<!--        @if (avatarMessage(); as message) {-->
<!--          <div-->
<!--            class="rounded-lg border p-4 text-sm"-->
<!--            [class]="message.type === 'success'-->
<!--              ? 'border-green-500/50 bg-green-500/10 text-green-400'-->
<!--              : 'border-error-500/50 bg-error-500/10 text-error-400'"-->
<!--          >-->
<!--            {{ message.text }}-->
<!--          </div>-->
<!--        }-->

<!--        @if (profileSuccess()) {-->
<!--          <div class="rounded-lg border border-green-500/50 bg-green-500/10 p-4 text-sm text-green-400">-->
<!--            {{ profileSuccess() }}-->
<!--          </div>-->
<!--        }-->
<!--        @if (userStore.updateProfile.error(); as error) {-->
<!--          <div class="rounded-lg border border-error-500/50 bg-error-500/10 p-4 text-sm text-error-400">-->
<!--            {{ error.message }}-->
<!--          </div>-->
<!--        }-->
<!--      </div>-->
<!--    }-->

    <!-- Profil Section -->
    <ui-page-section title="Profil">
      <!-- Grid 2 colonnes: Avatar à gauche, Form à droite -->
      <div class="grid gap-12 md:grid-cols-[auto_1fr]">
        <!-- Avatar -->
        <div class="flex flex-col items-center gap-4">
          @if (selectedAvatarPreview()) {
            <img
              [src]="selectedAvatarPreview()!"
              alt="Preview"
              class="h-24 w-24 rounded-full object-cover shadow-lg ring-2 ring-gold-500/20"
            />
          } @else {
            <ui-avatar [user]="currentUser()" size="lg" />
          }

          <input
            type="file"
            id="avatar-upload"
            accept="image/jpeg,image/png,image/webp"
            (change)="onAvatarFileSelected($event)"
            class="hidden"
          />
          <label
            for="avatar-upload"
            class="body-sm cursor-pointer text-gold-500 transition-colors hover:text-gold-400"
          >
            @if (uploadAvatarMutation.loading()) {
              Chargement...
            } @else {
              Changer la photo
            }
          </label>
          <p class="caption">JPG, PNG, WebP (max 5MB)</p>
        </div>

        <!-- Form -->
        <form [formGroup]="profileForm" (ngSubmit)="onUpdateProfile()" class="space-y-6">
          <ui-input
            inputId="displayName"
            type="text"
            label="Nom d'affichage"
            placeholder="Votre nom"
            [control]="profileForm.controls.displayName"
            [required]="true"
            autocomplete="name"
          />

          <div class="flex justify-end">
            <ui-button
              type="submit"
              variant="ghost"
              size="sm"
              class="text-gold-500 hover:text-gold-400 md:h-10 md:px-4 md:text-base"
              [loading]="userStore.updateProfile.loading()"
              [disabled]="profileForm.invalid || userStore.updateProfile.loading()"
            >
              Enregistrer
            </ui-button>
          </div>
        </form>
      </div>
    </ui-page-section>

    <!-- Compte Section -->
    <ui-page-section title="Compte">
      <div class="space-y-8">
        <!-- Email -->
        <div class="flex items-center justify-between border-b border-smoke-800 pb-6">
          <div class="flex-1">
            <p class="label">Email</p>
            <p class="mt-1 text-smoke-50">{{ currentUser()?.email }}</p>
            @if (isOAuthUser()) {
              <p class="caption mt-1">
                Connecté via {{ providerLabel() }}
              </p>
            }
          </div>
          <span
            class="caption rounded-full px-3 py-1 font-medium"
            [class]="
              isOAuthUser()
                ? 'bg-blue-500/10 text-blue-400'
                : 'bg-smoke-800 text-smoke-400'
            "
          >
            {{ providerLabel() }}
          </span>
        </div>

        <!-- Logout -->
        <div class="flex justify-end pt-4">
          <ui-button
            type="button"
            variant="ghost"
            size="sm"
            class="text-error-500 hover:text-error-400 md:h-10 md:px-4 md:text-base"
            [loading]="logoutLoading()"
            [disabled]="logoutLoading()"
            (click)="onLogout()"
          >
            Se déconnecter
          </ui-button>
        </div>
      </div>
    </ui-page-section>

    <!-- À propos Section -->
    <ui-page-section title="À propos" [bordered]="false">
      <div class="space-y-2">
        <p class="body">Cigar & Club - Application de gestion de clubs de dégustation</p>
        <p class="caption">Version 1.0.0</p>
      </div>
    </ui-page-section>
  </div>