<div class="container-page content-section-lg">
  <!-- Loading State (Skeleton) -->
  @if (profileLoading()) {
    <!-- Header Skeleton -->
    <ui-skeleton-profile avatarSize="avatar-lg" />

    <!-- Info Skeleton -->
    <div class="space-y-3 mt-4">
      <ui-skeleton size="text-md" />
      <ui-skeleton variant="text" width="100%" height="16px" />
      <ui-skeleton variant="text" width="80%" height="16px" />
    </div>

    <!-- Stats Section Skeleton -->
    <ui-page-section title="Statistiques">
      <ui-skeleton-stats [count]="3" [columns]="3" />
    </ui-page-section>

    <!-- Clubs Section Skeleton -->
    <ui-page-section title="Mes Clubs">
      <ui-skeleton-list [count]="4" variant="avatar" />
    </ui-page-section>
  }

  <!-- Error State -->
  @if (profileError() && !profileLoading()) {
    <div class="flex flex-col items-center justify-center py-12 space-y-4">
      <p class="text-red-400">Utilisateur introuvable</p>
    </div>
  }

  <!-- Profile Content -->
  @if (profile() && !profileLoading()) {
    <!-- Header: Avatar + DisplayName/Username (Desktop: same line) -->
    <div class="flex flex-col md:flex-row items-start md:items-center gap-4 md:gap-6">
      <ui-avatar [user]="user()" size="lg" />
      <div class="flex flex-col gap-1">
        <h1 class="heading-display">{{ primaryName() }}</h1>
        @if (shouldShowUsername()) {
          <p class="caption text-smoke-400">@{{ username() }}</p>
        }
      </div>
    </div>

    <!-- Info: Member Since + Bio -->
    <div class="space-y-3 mt-4">
      @if (createdAt()) {
        <p class="caption">
          Aficionado depuis {{ formatMemberSince(createdAt()) }}
        </p>
      }

      @if (bio()) {
        <p class="text-smoke-200">{{ bio() }}</p>
      }
    </div>

    <!-- Stats Section -->
    <ui-page-section title="Statistiques">
      <div class="grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-6">
        <!-- Evaluation Count -->
        <div class="rounded-lg bg-smoke-800/50 p-4 md:p-6 space-y-2">
          <p class="caption text-smoke-400">Dégustations</p>
          <p class="text-2xl md:text-3xl font-bold text-gold-500">
            {{ evaluationCount() }}
          </p>
        </div>

        <!-- Favorite Brand -->
        <div class="rounded-lg bg-smoke-800/50 p-4 md:p-6 space-y-2">
          <p class="caption text-smoke-400">Marque favorite</p>
          <p class="text-lg md:text-xl font-semibold text-smoke-50">
            @if (favoriteBrand()) {
              {{ favoriteBrand() }}
            } @else {
              <span class="text-smoke-500">—</span>
            }
          </p>
        </div>

        <!-- Club Count -->
        <div class="rounded-lg bg-smoke-800/50 p-4 md:p-6 space-y-2">
          <p class="caption text-smoke-400">Clubs</p>
          <p class="text-2xl md:text-3xl font-bold text-gold-500">
            {{ clubCount() }}
          </p>
        </div>
      </div>
    </ui-page-section>

    <!-- Clubs Section -->
    <ui-page-section title="Mes Clubs">
      @if (clubsLoading()) {
        <ui-skeleton-list [count]="4" variant="avatar" />
      }

      @if (!clubsLoading() && hasClubs()) {
        <!-- Horizontal scroll of club avatars with tooltip -->
        <div class="flex gap-6 overflow-x-auto py-3">
          @for (club of clubs(); track club.id) {
            <div
              class="group flex-shrink-0 cursor-pointer"
              (click)="navigateToClub(club.slug)"
              [uiTooltip]="club.name"
              [tooltipPosition]="'bottom'"
            >
              <div class="ring-2 ring-smoke-700 group-hover:ring-gold-500 rounded-full transition-all duration-200">
                <ui-avatar
                  [club]="{ id: club.id, name: club.name, imageUrl: club.imageUrl ?? null }"
                  size="lg"
                />
              </div>
            </div>
          }
        </div>
      }

      @if (!clubsLoading() && !hasClubs()) {
        <div class="flex items-center justify-center py-8">
          <p class="text-smoke-400">Aucun club</p>
        </div>
      }
    </ui-page-section>
  }
</div>